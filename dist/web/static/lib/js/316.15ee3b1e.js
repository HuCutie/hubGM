"use strict";(self["webpackChunkvue3_template"]=self["webpackChunkvue3_template"]||[]).push([[316],{723:function(e,l,t){t.d(l,{F9:function(){return s},P4:function(){return o},Qj:function(){return r},bN:function(){return n},eo:function(){return d},jw:function(){return u},lw:function(){return i}});var a=t(9408);const o=e=>a.L.request({url:"/gm/account/list",method:"get",params:e}),n=(e,l)=>a.L.request({url:`/gm/account/${e}/recharge`,method:"post",data:l}),r=e=>a.L.request({url:`/gm/account/${e}/reset_create_charac`,method:"post"}),i=e=>a.L.request({url:`/gm/account/${e}`,method:"delete"}),u=(e,l)=>a.L.request({url:`/gm/account/${e}/change_password`,method:"post",data:l}),s=(e,l)=>a.L.request({url:`/gm/account/${e}`,method:"put",data:l}),d=e=>a.L.request({url:"/gm/account",method:"post",data:e})},2731:function(e,l,t){t.d(l,{Cq:function(){return n},O0:function(){return o},tJ:function(){return r}});var a=t(9408);const o=e=>a.L.request({url:`/gm/account/${e}/roles`,method:"get"}),n=(e,l)=>a.L.request({url:`/gm/roles/${e}/qp`,method:"put",data:l}),r=(e,l)=>a.L.request({url:`/gm/roles/${e}/pvp`,method:"put",data:l})},2900:function(e,l,t){t.d(l,{A:function(){return g}});var a=t(2987),o=t(6768),n=t(4232);const r={class:"bot",style:{height:"20px","margin-bottom":"10px",background:"#fff"}},i={class:"bline-dotted"},u={class:"category-index"},s={class:"category-name"},d={style:{padding:"10px 30px 20px"}};function p(e,l,t,a,p,c){const f=(0,o.g2)("el-col"),m=(0,o.g2)("el-row");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(m,{class:(0,n.C4)(t.isLast?"last-step":"")},{default:(0,o.k6)((()=>[(0,o.bF)(f,{span:24},{default:(0,o.k6)((()=>[(0,o.Lk)("div",r,[(0,o.Lk)("div",i,[(0,o.Lk)("div",u,(0,n.v_)(t.num),1),(0,o.Lk)("div",s,(0,n.v_)(t.title),1)])])])),_:1})])),_:1},8,["class"]),(0,o.Lk)("div",null,[(0,o.Lk)("div",d,[(0,o.Lk)("div",{class:(0,n.C4)(t.isLast?"last-div":"")},[(0,o.RG)(e.$slots,"default",{},void 0,!0)],2)])])])}var c={name:"PanelStep",props:{num:{type:[String,Number],required:!0,default:1},title:{type:String},isLast:{type:Boolean,default:!1}}},f=t(1241);const m=(0,f.A)(c,[["render",p],["__scopeId","data-v-10870d64"]]);var b=m;const v=(0,a.GU)(b);var g=v},9850:function(e,l,t){t.d(l,{A:function(){return v}});var a=t(2987),o=(t(8743),t(6768)),n=t(4232),r=t(4469),i=t(1387);const u=e=>((0,o.Qi)("data-v-221fb25f"),e=e(),(0,o.jt)(),e),s={class:"pull-left"},d=u((()=>(0,o.Lk)("span",{class:"icon-toinstlist"},null,-1)));var p=(0,o.pM)({__name:"PanelTitle",props:{isLine:r.t.bool.def(!1),title:r.t.string.def("标题"),router:Object,backTitle:r.t.string.def("")},setup(e){const l=e,t=(0,i.rd)(),a=()=>{l.router?t.push({...l.router}):t.go(-1)};return(l,t)=>{const r=(0,o.g2)("el-button"),i=(0,o.g2)("el-row");return(0,o.uX)(),(0,o.Wv)(i,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",{class:(0,n.C4)(["console-title clearfix",e.isLine?"bline":""]),style:{"min-height":"50px"}},[(0,o.Lk)("div",s,[(0,o.Lk)("h4",null,(0,n.v_)(e.title),1),Boolean(e.backTitle)?((0,o.uX)(),(0,o.Wv)(r,{key:0,size:"small",class:"btn-small",onClick:a},{default:(0,o.k6)((()=>[d,(0,o.Lk)("span",null,(0,n.v_)(e.backTitle),1)])),_:1})):(0,o.Q3)("",!0),(0,o.RG)(l.$slots,"button")])],2)])),_:3})}}}),c=t(1241);const f=(0,c.A)(p,[["__scopeId","data-v-221fb25f"]]);var m=f;const b=(0,a.GU)(m);var v=b},8632:function(e,l,t){t.d(l,{tf:function(){return o}});var a=t(144);async function o(e,l=!1){const t=(0,a.R1)(e).validate;return new Promise((e=>t(((t,a)=>e(l?{valid:t,object:a}:t)))))}},2987:function(e,l,t){t.d(l,{GU:function(){return a}});const a=(e,l)=>{if(e.install=t=>{for(const a of[e,...Object.values(l??{})])t.component(a.name,a)},l)for(const[t,a]of Object.entries(l))e[t]=a;return e}},5316:function(e,l,t){t.r(l),t.d(l,{default:function(){return Q}});var a=t(6768),o=t(144),n=t(9850),r=t(2900),i=t(4232),u=t(9796),s=t(8632),d=t(2731),p=t(8515);const c={class:"text-gray-lg sm"},f=(0,a.Lk)("div",{style:{"margin-left":"100px"}},[(0,a.Lk)("span",{class:"text-warning sm"},"注：角色转职后，可以修改！")],-1),m={class:"dialog-footer"};var b=(0,a.pM)({__name:"RoleQPDialog",emits:["reloadRoles"],setup(e,{expose:l,emit:t}){const n=(0,o.Kh)({visible:!1,title:""}),r=(0,o.KR)(),u=(0,o.Kh)({qp:800}),b=(0,o.Kh)({qp:[{type:"integer",min:0,message:"QP值至少未0",trigger:"blur"}]}),v=(0,o.KR)(null);let g=null;const k=e=>{n.visible=!0,n.title="修改QP",v.value=e.QP,g=e.charac_no,(0,a.dY)((()=>{r.value.resetFields()}))},_=async()=>{const e=await(0,s.tf)(r);if(e)try{await(0,d.Cq)(g,u),(0,p.Jl)("更新成功"),n.visible=!1,t("reloadRoles")}catch(l){}};return l({showQpDialog:k}),(e,l)=>{const t=(0,a.g2)("el-form-item"),o=(0,a.g2)("el-input-number"),s=(0,a.g2)("el-form"),d=(0,a.g2)("el-col"),p=(0,a.g2)("el-row"),g=(0,a.g2)("el-button"),k=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(k,{modelValue:n.visible,"onUpdate:modelValue":l[2]||(l[2]=e=>n.visible=e),title:n.title,width:"600px","close-on-press-escape":!1,"close-on-click-modal":!1},{footer:(0,a.k6)((()=>[(0,a.Lk)("span",m,[(0,a.bF)(g,{onClick:l[1]||(l[1]=e=>n.visible=!1)},{default:(0,a.k6)((()=>[(0,a.eW)("取 消")])),_:1}),(0,a.bF)(g,{type:"primary",onClick:_},{default:(0,a.k6)((()=>[(0,a.eW)("确 定")])),_:1})])])),default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{span:22},{default:(0,a.k6)((()=>[(0,a.bF)(s,{model:u,rules:b,ref_key:"formRef",ref:r,"label-width":"100px"},{default:(0,a.k6)((()=>[(0,a.bF)(t,{label:"现有QP"},{default:(0,a.k6)((()=>[(0,a.Lk)("span",c,(0,i.v_)(v.value),1)])),_:1}),(0,a.bF)(t,{label:"修改QP",prop:"qp"},{default:(0,a.k6)((()=>[(0,a.bF)(o,{min:0,modelValue:u.qp,"onUpdate:modelValue":l[0]||(l[0]=e=>u.qp=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),f])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1},8,["modelValue","title"])])}}});const v=b;var g=v;const k={class:"dialog-footer"};var _=(0,a.pM)({__name:"RolePvpDialog",emits:["reloadRoles"],setup(e,{expose:l,emit:t}){const n=(0,o.Kh)({visible:!1,title:""}),r=(0,o.KR)();let i=(0,o.Kh)({win:0,pvp_grade:0,pvp_point:0});const c=(0,o.Kh)({pvp_grade:[{type:"integer",min:0,max:34,message:"pk段位0至34",trigger:"blur"}]});let f=null;const m=e=>{n.visible=!0,n.title="修改PK段位",f=e.charac_no,(0,a.dY)((()=>{(0,u.po)(i,e.pvp),r.value.clearValidate()}))},b=async()=>{const e=await(0,s.tf)(r);if(e)try{await(0,d.tJ)(f,i),(0,p.Jl)("更新成功"),n.visible=!1,t("reloadRoles")}catch(l){}};return l({showPvpDialog:m}),(e,l)=>{const t=(0,a.g2)("el-input-number"),u=(0,a.g2)("el-form-item"),s=(0,a.g2)("el-form"),d=(0,a.g2)("el-col"),p=(0,a.g2)("el-row"),f=(0,a.g2)("el-button"),m=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(m,{modelValue:n.visible,"onUpdate:modelValue":l[4]||(l[4]=e=>n.visible=e),title:n.title,width:"600px","close-on-press-escape":!1,"close-on-click-modal":!1},{footer:(0,a.k6)((()=>[(0,a.Lk)("span",k,[(0,a.bF)(f,{onClick:l[3]||(l[3]=e=>n.visible=!1)},{default:(0,a.k6)((()=>[(0,a.eW)("取 消")])),_:1}),(0,a.bF)(f,{type:"primary",onClick:b},{default:(0,a.k6)((()=>[(0,a.eW)("确 定")])),_:1})])])),default:(0,a.k6)((()=>[(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{span:22},{default:(0,a.k6)((()=>[(0,a.bF)(s,{model:(0,o.R1)(i),rules:c,ref_key:"formRef",ref:r,"label-width":"100px"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{label:"PK段位",prop:"pvp_grade"},{default:(0,a.k6)((()=>[(0,a.bF)(t,{min:0,max:34,modelValue:(0,o.R1)(i).pvp_grade,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,o.R1)(i).pvp_grade=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),(0,a.bF)(u,{label:"胜利场次",prop:"win"},{default:(0,a.k6)((()=>[(0,a.bF)(t,{min:0,modelValue:(0,o.R1)(i).win,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,o.R1)(i).win=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),(0,a.bF)(u,{label:"胜点",prop:"pvp_point"},{default:(0,a.k6)((()=>[(0,a.bF)(t,{min:0,max:99,modelValue:(0,o.R1)(i).pvp_point,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,o.R1)(i).pvp_point=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1},8,["modelValue","title"])])}}});const h=_;var y=h;const R={key:0},F={key:1};var w=(0,a.pM)({__name:"RolesTable",props:{data:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,required:!0,default:!1}},emits:["reloadRoles"],setup(e,{emit:l}){const t=(0,o.KR)(),n=e=>{t.value.showQpDialog(e)},r=(0,o.KR)(),s=e=>{r.value.showPvpDialog(e)},d=()=>{l("reloadRoles")};return(l,p)=>{const c=(0,a.g2)("el-table-column"),f=(0,a.g2)("el-button"),m=(0,a.g2)("el-table"),b=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(m,{data:e.data,ref:"tableRef",border:""},{default:(0,a.k6)((()=>[(0,a.bF)(c,{prop:"charac_no",label:"角色编号",width:"120"}),(0,a.bF)(c,{prop:"charac_name",label:"角色名称",width:"180"}),(0,a.bF)(c,{prop:"money",label:"金币",width:"180"},{default:(0,a.k6)((e=>[(0,a.Lk)("span",null,(0,i.v_)((0,o.R1)(u.$g)(e.row.money)),1)])),_:1}),(0,a.bF)(c,{prop:"QP",label:"QP",width:"120"}),(0,a.bF)(c,{prop:"create_time",label:"创建时间",width:"180"},{default:(0,a.k6)((e=>[(0,a.Lk)("span",null,(0,i.v_)((0,o.R1)(u.i$)(e.row.create_time)),1)])),_:1}),(0,a.bF)(c,{prop:"lev",label:"等级"}),(0,a.bF)(c,{prop:"pvp.pvp_grade",label:"PK等级",width:"100"},{default:(0,a.k6)((e=>[e.row.pvp.pvp_grade?((0,a.uX)(),(0,a.CE)("span",R,(0,i.v_)(e.row.pvp.pvp_grade),1)):((0,a.uX)(),(0,a.CE)("span",F,"-"))])),_:1}),(0,a.bF)(c,{label:"操作",width:"180",align:"right"},{default:(0,a.k6)((e=>[(0,a.bF)(f,{type:"primary",link:"",size:"small",onClick:l=>n(e.row)},{default:(0,a.k6)((()=>[(0,a.eW)("修改QP")])),_:2},1032,["onClick"]),(0,a.bF)(f,{type:"primary",link:"",size:"small",onClick:l=>s(e.row)},{default:(0,a.k6)((()=>[(0,a.eW)("修改PK段位")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[b,e.loading]]),(0,a.bF)((0,o.R1)(g),{ref_key:"qpDialogRef",ref:t,onReloadRoles:d},null,512),(0,a.bF)((0,o.R1)(y),{ref_key:"pvpDialogRef",ref:r,onReloadRoles:d},null,512)])}}});const L=w;var C=L,x=t(618);const q={class:"tc-step-border"},K={class:"l"};var V=(0,a.pM)({__name:"index",setup(e){const l=(0,o.Kh)({data:[],loading:!1});let t=null;const i=e=>{t=e,u()},u=async()=>{try{l.loading=!0,l.data=await(0,d.O0)(t),l.loading=!1}catch(e){l.loading=!1}};return(e,t)=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)((0,o.R1)(n.A),{title:"角色管理"}),(0,a.Lk)("div",q,[(0,a.Lk)("div",K,[(0,a.bF)((0,o.R1)(r.A),{num:"1",title:"账号选择"},{default:(0,a.k6)((()=>[(0,a.bF)((0,o.R1)(x.A),{onSetUid:i})])),_:1}),(0,a.bF)((0,o.R1)(r.A),{num:"2",title:"角色信息","is-last":""},{default:(0,a.k6)((()=>[(0,a.bF)((0,o.R1)(C),{data:l.data,loading:l.loading,onReloadRoles:u},null,8,["data","loading"])])),_:1})])])]))}});const P=V;var Q=P},618:function(e,l,t){t.d(l,{A:function(){return c}});var a=t(6768),o=t(144),n=t(4232),r=t(723),i=t(8632);const u={style:{float:"left"}},s={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}};var d=(0,a.pM)({__name:"SelectAccount",props:{hasRole:{type:Boolean,default:!0},hasBtn:{type:Boolean,default:!0},labelWidth:{type:String,default:"100px"},enableEventChange:{type:Boolean,default:!1}},emits:["setUid"],setup(e,{emit:l}){const t=e,{hasRole:d,hasBtn:p,labelWidth:c}=(0,o.QW)(t),f=(0,o.KR)(),m=(0,o.Kh)({uid:18e6}),b=(0,o.Kh)({uid:[{required:!0,message:"请选择账号",trigger:"blur"}]}),v=(0,o.Kh)({data:[]}),g=(0,o.KR)(!1),k=async()=>{g.value=!0,v.data=await(0,r.P4)({has_roles:d.value}),g.value=!1},_=async()=>{if(!t.enableEventChange)return;const e=await(0,i.tf)(f);e&&l("setUid",m.uid)},h=async()=>{const e=await(0,i.tf)(f);e&&l("setUid",m.uid)};return k(),(e,l)=>{const t=(0,a.g2)("el-option"),r=(0,a.g2)("el-select"),i=(0,a.g2)("el-form-item"),d=(0,a.g2)("el-button"),k=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(k,{model:m,rules:b,ref_key:"formRef",ref:f,"label-width":(0,o.R1)(c)},{default:(0,a.k6)((()=>[(0,a.bF)(i,{label:"账号ID",prop:"uid"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:m.uid,"onUpdate:modelValue":l[0]||(l[0]=e=>m.uid=e),onChange:_,filterable:"",clearable:"",placeholder:"选择账号id",loading:g.value,"loading-text":"正在加载账号"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(v.data,(e=>((0,a.uX)(),(0,a.Wv)(t,{key:e.uid,label:e.uid,value:e.uid},{default:(0,a.k6)((()=>[(0,a.Lk)("span",u,(0,n.v_)(e.uid),1),(0,a.Lk)("span",s," 角色数:"+(0,n.v_)(e.roles),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","loading"])])),_:1}),(0,o.R1)(p)?((0,a.uX)(),(0,a.Wv)(i,{key:0},{default:(0,a.k6)((()=>[(0,a.bF)(d,{type:"primary",onClick:h,size:"small"},{default:(0,a.k6)((()=>[(0,a.eW)("查询")])),_:1})])),_:1})):(0,a.Q3)("",!0)])),_:1},8,["model","rules","label-width"])])}}});const p=d;var c=p}}]);